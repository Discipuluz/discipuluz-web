<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-input/paper-textarea.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/iron-form/iron-form.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/iron-media-query/iron-media-query.html">
<link rel="import" href="../../bower_components/gold-email-input/gold-email-input.html">


<link rel="import" href="../discipuluz-components/discipuluz-card.html">

<dom-module id="discipuluz-contato">
  <template>
    <style is="custom-style" include="iron-flex iron-flex-factors iron-flex-alignment">
      .icon{
        margin-left: 5px;
      }
      paper-button{
        background-color: var(--primary-title-color);
        color: white;
      }

    </style>
    <!-- <iron-ajax
    id="submitRequest"
    url="http://localhost:8888/web/contact"
    method="post"
    body="[[_computeRequestBody(txtName, txtEmail, txtMessage)]]"
    handle-as="json"
    on-response="handleResponse"
    on-error="handleError"></iron-ajax> -->

    <iron-media-query query="max-width: 767px" query-matches="{{smallScreen}}"></iron-media-query>

    <div class="layout horizontal">
      <template is="dom-if" if="[[!smallScreen]]">
        <div class="flex-2"></div>
      </template>
      <discipuluz-card title="Contato" class="flex-3 contact-card">
        <form is="iron-form" method="post" action="http://localhost:8888/web/contact" on-iron-form-response="_formResponse" id="formContact">
          <div class="card-content">
            <div class="layout vertical">
              <div class="layout horizontal">
                <paper-input required class="flex" label="Qual seu nome?" name="name"></paper-input>
              </div>
              <div class="layout horizontal">
                <gold-email-input class="flex" auto-validate label="Email"
                  regex="^[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?$"
                  error-message="Por favor, entre com um email vÃ¡lido"  name="email"></gold-email-input>
              </div>
              <div class="layout horizontal">
                <paper-textarea class="flex" label="Mensagem"  name="message"></paper-textarea>
              </div>
              <div class="layout horizontal end-justified">
                  <paper-button class$="[[_flexIfSmallScreen(smallScreen)]]" raised on-tap="_submitForm">Enviar <iron-icon class="icon" icon="send"></iron-icon></paper-button>
              </div>
            </div>
          </div>
        </form>
      </discipuluz-card>
      <template is="dom-if" if="[[!smallScreen]]">
        <div class="flex-2"></div>
      </template>
    </div>
  </template>


  <script>
  Polymer({

    is: 'discipuluz-contato',

    handleResponde: function(res){
      console.log(res)
    },
    handleError: function(err){
      console.log(err)
    },
    _computeRequestBody: function(txtName, txtEmail, txtMessage){
      return {
        name: txtName,
        email: txtEmail,
        message: txtMessage
      }
    },
    _flexIfSmallScreen: function(smallScreen){
      if(smallScreen){
        return 'flex'
      }
    },
    _formResponse: function(e){
      console.log(e.detail.response)
    },
    _submitForm: function(){
      this.$.formContact.submit()
    }
  })
  </script>

</dom-module>
